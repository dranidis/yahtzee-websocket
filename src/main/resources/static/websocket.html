<!DOCTYPE html>
<html lang="en">

<head>
</head>

<body>
    <p>
        <input id="playerName" type="text" value="Dimitris" />
        <button id="addPlayerBtn">Add Player</button>
    </p>
    <div>Players
        <div id="playerList">
        </div>
    </div>

    <!--  Scripts-->
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

    <!-- /https://github.com/sockjs/sockjs-client -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>

    <script>
        var ws;

        (function ($) {
            $(function () {

                function addPlayerToList(name) {
                    $('#playerList').html(name);
                }

                /*
                Websockets client
                */
                function start(wsurl) {
                    ws = new SockJS("gamews");
                    ws.onopen = function () {
                        // ws.send('Here I am!');
                    }

                    ws.onmessage = function (event) {
                        console.log('message:' + event.data);
                        addPlayerToList(event.data);
                    }

                    ws.onclose = function (event) {
                        console.log('closed:' + event.code);
                        setTimeout(function () { start(wsurl) }, 5000);
                    }
                }

                start("/gamews");
                // ws = new SockJS("/gamews");

                // ws.onopen = function () {
                //     // ws.send('Here I am!');
                // }

                // ws.onmessage = function (event) {
                //     console.log('message:' + event.data);
                //     addPlayerToList(event.data);
                // }

                // ws.onclose = function (event) {
                //     console.log('closed:' + event.code);
                // }

                var playerName = "";
                $("#addPlayerBtn").click(function () {
                    var data = JSON.stringify({
                        'command': 'addplayer',
                        'player': $("#playerName").val()
                    })
                    ws.send(data);
                    $("#addPlayerBtn").prop('disabled', true);
                    // $('.enableOnInput').prop('disabled', true);
                });


                // // WS send a question
                // $("#sendQuestion").click(function () {
                //     var text = $('#questiontxt').val();
                //     $('#questiontxt').val("");

                //     ws.send(text);
                // })

            }); // end of document ready
        })(jQuery); // end of jQuery name space
    </script>


</body>

</html>